<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script>






window.onload = async () => {

    class Timeout {
    constructor() {
        this.timerId = null;
    }

    set = (delay, reason) =>
        new Promise((resolve, reject) => {
            this.timerId = setTimeout(() => {
                if (reason === undefined) resolve();
                else reject(reason);
                this.clear();
            }, delay);
        });

    wrap = (promise, delay, reason) =>
        Promise.race([promise, this.set(delay, reason)]);

    clear = () => {
        if (this.timerId) {
            clearTimeout(this.timerId);
        }
    };
}

function res() {
         return new Promise((resolve, reject) => {
            const intervalId = window.setInterval(() => {
                window.clearInterval(intervalId);
                resolve('Hello');
            }, 1000);
        });
}

const myFunc = async () => {
    const timeout = new Timeout();
    return timeout.wrap(res(), 0.00001, {
            reason: 'Operation timeout',
        }).finally(() => timeout.clear());
};






 var res =   await myFunc();
 console.log("res");
 console.log(res);
};




</script>

</body>
</html>



